<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute the Nystuen and Dacey graph for a spatial interaction model — nd_graph • blvim</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the Nystuen and Dacey graph for a spatial interaction model — nd_graph"><meta name="description" content="This function computes the most important flows in a spatial interaction
model according to the approach outlined by J. D. Nystuen and M. F. Dacey
(Nystuen &amp;amp; Dacey, 1961. In this work, a nodal flow is the largest flow sent
from a non terminal location (based on the definition of terminals recalled
in terminals()). The nodal structure is the collection of those flows.
They form an oriented graph that has interesting properties. In particular
each weakly connected component contains a single terminal location which can
be seen as the dominant location of the component. Notice that because nodal
flows are based on terminals, this function applies only to the non bipartite
setting."><meta property="og:description" content="This function computes the most important flows in a spatial interaction
model according to the approach outlined by J. D. Nystuen and M. F. Dacey
(Nystuen &amp;amp; Dacey, 1961. In this work, a nodal flow is the largest flow sent
from a non terminal location (based on the definition of terminals recalled
in terminals()). The nodal structure is the collection of those flows.
They form an oriented graph that has interesting properties. In particular
each weakly connected component contains a single terminal location which can
be seen as the dominant location of the component. Notice that because nodal
flows are based on terminals, this function applies only to the non bipartite
setting."><meta property="og:image" content="https://fabrice-rossi.github.io/blvim/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blvim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/grid.html">Systematic exploration of the BLV solution space</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theoretical Background</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://fabrice-rossi.github.io/blog/posts/blvim-0-1.html">blvim 0.1.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fabrice-rossi/blvim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute the Nystuen and Dacey graph for a spatial interaction model</h1>
      <small class="dont-index">Source: <a href="https://github.com/fabrice-rossi/blvim/blob/main/R/nd_graph.R" class="external-link"><code>R/nd_graph.R</code></a></small>
      <div class="d-none name"><code>nd_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the most important flows in a spatial interaction
model according to the approach outlined by J. D. Nystuen and M. F. Dacey
(Nystuen &amp; Dacey, 1961. In this work, a <em>nodal flow</em> is the largest flow sent
from a non terminal location (based on the definition of terminals recalled
in <code><a href="terminals.html">terminals()</a></code>). The <em>nodal structure</em> is the collection of those flows.
They form an oriented graph that has interesting properties. In particular
each weakly connected component contains a single terminal location which can
be seen as the dominant location of the component. Notice that because nodal
flows are based on terminals, this function applies only to the non bipartite
setting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nd_graph</span><span class="op">(</span><span class="va">sim</span>, definition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ND"</span>, <span class="st">"RW"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sim'</span></span>
<span><span class="fu">nd_graph</span><span class="op">(</span><span class="va">sim</span>, definition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ND"</span>, <span class="st">"RW"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sim">sim<a class="anchor" aria-label="anchor" href="#arg-sim"></a></dt>
<dd><p>a spatial interaction model object</p></dd>


<dt id="arg-definition">definition<a class="anchor" aria-label="anchor" href="#arg-definition"></a></dt>
<dd><p>terminal definition, either <code>"ND"</code> (for Nystuen &amp; Dacey,
default) or <code>"RW"</code> (for Rihll &amp; Wilson), see details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame describing the Nystuen and Dacey graph a.k.a. the nodal
structure of a spatial interaction model</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In practice, the function computes first the terminals and non terminals
according to either Nystuen &amp; Dacey (1961) or Rihll and Wilson (1991). Then
it extracts the nodal flows. The result of the analysis is returned as a data
frame with three columns:</p><ul><li><p><code>from</code>: the index of the non terminal origin location</p></li>
<li><p><code>to</code>: the index of destination location of the nodal flow of <code>from</code></p></li>
<li><p><code>flow</code>: the value of the nodal flow</p></li>
</ul><p>An important aspect of the node structure is that is does not contain
isolated terminals. If a location is a terminal but is never the receiver of
a nodal flow it will not appear in the collection of nodal flows. It
constitutes a a trivial connected component in itself.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nystuen, J.D. and Dacey, M.F. (1961), "A graph theory
interpretation of nodal regions", Papers and Proceedings of the Regional
Science Association 7: 29-42. <a href="https://doi.org/10.1007/bf01969070" class="external-link">doi:10.1007/bf01969070</a></p>
<p>Rihll, T., and Wilson, A. (1991), "Modelling settlement structures in
ancient Greece: new approaches to the polis", In City and Country in the
Ancient World, Vol. 3, Edited by J. Rich and A. Wallace-Hadrill, 58-95.
London: Routledge.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sim_is_bipartite.html">sim_is_bipartite()</a></code>, <code><a href="is_terminal.html">is_terminal()</a></code>, <code><a href="terminals.html">terminals()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="va">french_cities_distances</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span> <span class="co">## convert to km</span></span></span>
<span class="r-in"><span><span class="va">production</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">attractiveness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="blvim.html">blvim</a></span><span class="op">(</span><span class="va">distances</span>, <span class="va">production</span>, <span class="fl">1.3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">250</span>, <span class="va">attractiveness</span>,</span></span>
<span class="r-in"><span>  bipartite <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="destination_names.html">destination_names</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">french_cities</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">nd_graph</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            from to      flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marseille     2  7 0.9488844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lyon          3  7 0.7594037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toulouse      4  7 0.9046308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nice          5  7 0.9488844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nantes        6  1 0.7793698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Strasbourg    8  1 0.6655188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bordeaux      9  7 0.7106013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lille        10  1 0.9291846</span>
<span class="r-in"><span><span class="va">dist_times</span> <span class="op">&lt;-</span> <span class="va">french_cities_times</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="blvim.html">blvim</a></span><span class="op">(</span><span class="va">dist_times</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fl">1.3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">5000</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  bipartite <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="destination_names.html">destination_names</a></span><span class="op">(</span><span class="va">tmodel</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">french_cities</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="terminals.html">terminals</a></span><span class="op">(</span><span class="va">tmodel</span>, definition <span class="op">=</span> <span class="st">"RW"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Paris  Marseille       Lyon   Toulouse Strasbourg   Bordeaux     Rennes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          8          9         11 </span>
<span class="r-in"><span><span class="fu">nd_graph</span><span class="op">(</span><span class="va">tmodel</span>, <span class="st">"RW"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               from to      flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nice             5  2 0.9620972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nantes           6 11 0.5920218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Montpellier      7  2 0.8707174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lille           10  1 0.9551241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Toulon          12  2 0.9727568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reims           13  1 0.9308482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saint-Étienne   14  3 0.5062502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Le Havre        15  1 0.8529081</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fabrice Rossi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

