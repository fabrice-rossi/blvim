<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute an equilibrium solution of the Boltzmann–Lotka–Volterra model — blvim • blvim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute an equilibrium solution of the Boltzmann–Lotka–Volterra model — blvim"><meta name="description" content="This function computes flows between origin locations and destination
locations at an equilibrium solution of A. Wilson's Boltzmann–Lotka–Volterra
(BLV) interaction model. The BLV dynamic model is initialised with the
production constraints at the origin locations and the initial values of the
the attractiveness of destination locations. Iterations update the
attractivenesses according the received flows."><meta property="og:description" content="This function computes flows between origin locations and destination
locations at an equilibrium solution of A. Wilson's Boltzmann–Lotka–Volterra
(BLV) interaction model. The BLV dynamic model is initialised with the
production constraints at the origin locations and the initial values of the
the attractiveness of destination locations. Iterations update the
attractivenesses according the received flows."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blvim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute an equilibrium solution of the Boltzmann–Lotka–Volterra model</h1>

      <div class="d-none name"><code>blvim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes flows between origin locations and destination
locations at an equilibrium solution of A. Wilson's Boltzmann–Lotka–Volterra
(BLV) interaction model. The BLV dynamic model is initialised with the
production constraints at the origin locations and the initial values of the
the attractiveness of destination locations. Iterations update the
attractivenesses according the received flows.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">blvim</span><span class="op">(</span></span>
<span>  <span class="va">costs</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">alpha</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">Z</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  conv_check <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  precision <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  quadratic <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-costs">costs<a class="anchor" aria-label="anchor" href="#arg-costs"></a></dt>
<dd><p>a cost matrix</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector of production constraints</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>the return to scale parameter</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>the cost inverse scale parameter</p></dd>


<dt id="arg-z">Z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>a vector of initial destination attractivenesses</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>the update intensity</p></dd>


<dt id="arg-iter-max">iter_max<a class="anchor" aria-label="anchor" href="#arg-iter-max"></a></dt>
<dd><p>the maximal number of steps of the BLV dynamic</p></dd>


<dt id="arg-conv-check">conv_check<a class="anchor" aria-label="anchor" href="#arg-conv-check"></a></dt>
<dd><p>number of iterations between to convergence test</p></dd>


<dt id="arg-precision">precision<a class="anchor" aria-label="anchor" href="#arg-precision"></a></dt>
<dd><p>convergence threshold</p></dd>


<dt id="arg-quadratic">quadratic<a class="anchor" aria-label="anchor" href="#arg-quadratic"></a></dt>
<dd><p>selects the update rule, see details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <code>sim</code> for spatial interaction model that contains
the matrix of flows between the origin and the destination locations as well
as the final attractivenesses computed by the model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In a step of the BLV model, flows are computed according to the production
constrained entropy maximising model proposed by A. Wilson and implemented in
<code><a href="static_blvim.html">static_blvim()</a></code>. Then the flows received at a destination are computed as
follows</p>
<p>$$\forall i,\quad D_j=\sum_{i=1}^{n}Y_{ij},$$</p>
<p>for destination \(j\). This enables updating the attractivenesses by making
them closer to the received flows, i.e. trying to reduce \(|D_j-Z_j|\).</p>
<p>A. Wilson and co-authors proposed two different update strategies:</p><ol><li><p>The original model proposed in Harris &amp; Wilson (1978) updates the
\(Z_j\) as follows $$Z_j^{t+1} = Z_j^{t} + \epsilon (D^{t}_j-Z^{t}_j)$$</p></li>
<li><p>In Wilson (2008), the update is given by $$Z_j^{t+1} = Z_j^{t} +
\epsilon (D^{t}_j-Z^{t}_j)Z^{t}_j$$</p></li>
</ol><p>In both cases, \(\epsilon\) is given by the <code>epsilon</code> parameter. It should
be smaller than 1. The first update is used when the <code>quadratic</code>
parameter is <code>FALSE</code> which is the default value. The second update is used
when <code>quadratic</code> is <code>TRUE</code>.</p>
<p>Updates are performed until convergence or for a maximum of <code>iter_max</code> iterations.
Convergence is checked every <code>conv_check</code> iterations. The algorithm is
considered to have converged if
$$\|Z^{t+1}-Z^t\|&lt;\delta (\|Z^{t+1}\|+\delta),$$
where \(\delta\) is given by the <code>precision</code> parameter.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harris, B., &amp; Wilson, A. G. (1978). "Equilibrium Values and
Dynamics of Attractiveness Terms in Production-Constrained
Spatial-Interaction Models", Environment and Planning A: Economy and Space,
10(4), 371-388. <a href="https://doi.org/10.1068/a100371" class="external-link">doi:10.1068/a100371</a></p>
<p>Wilson, A. (2008), "Boltzmann, Lotka and Volterra and spatial structural
evolution: an integrated methodology for some dynamical systems", J. R.
Soc. Interface.5865–871 <a href="https://doi.org/10.1098/rsif.2007.1288" class="external-link">doi:10.1098/rsif.2007.1288</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">positions</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">production</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">attractiveness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">flows</span> <span class="op">&lt;-</span> <span class="fu">blvim</span><span class="op">(</span><span class="va">distances</span>, <span class="va">production</span>, <span class="fl">1.5</span>, <span class="fl">1</span>, <span class="va">attractiveness</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fabrice Rossi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

