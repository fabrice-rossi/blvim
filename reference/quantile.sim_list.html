<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute quantiles of the flows in a collection of spatial interaction models — quantile.sim_list • blvim</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute quantiles of the flows in a collection of spatial interaction models — quantile.sim_list"><meta name="description" content="The function computes the specified quantiles for individual or aggregated
flows in a collection of spatial interaction models."><meta property="og:description" content="The function computes the specified quantiles for individual or aggregated
flows in a collection of spatial interaction models."><meta property="og:image" content="https://fabrice-rossi.github.io/blvim/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blvim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/grid.html">Systematic exploration of the BLV solution space</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theoretical Background</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fabrice-rossi/blvim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute quantiles of the flows in a collection of spatial interaction models</h1>
      <small class="dont-index">Source: <a href="https://github.com/fabrice-rossi/blvim/blob/main/R/sim_list_stats.R" class="external-link"><code>R/sim_list_stats.R</code></a></small>
      <div class="d-none name"><code>quantile.sim_list.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function computes the specified quantiles for individual or aggregated
flows in a collection of spatial interaction models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'sim_list'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"destination"</span>, <span class="st">"attractiveness"</span><span class="op">)</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  normalisation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"origin"</span>, <span class="st">"full"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a collection of spatial interaction models, a <code>sim_list</code></p></dd>


<dt id="arg-flows">flows<a class="anchor" aria-label="anchor" href="#arg-flows"></a></dt>
<dd><p><code>"full"</code> (default),  <code>"destination"</code> or <code>"attractiveness"</code>, see
details.</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>numeric vector of probabilities with values in \([0,1]\).</p></dd>


<dt id="arg-normalisation">normalisation<a class="anchor" aria-label="anchor" href="#arg-normalisation"></a></dt>
<dd><p>when <code>flows="full"</code>, the flows are used as is, that
without normalisation (<code>normalisation="none"</code>, default case) or they can be
normalised prior the calculation of the quantiles, either to sum to one
for each origin location (<code>normalisation="origin"</code>) or to sum to one globally
(<code>normalisation="full"</code>). This is useful for <code><a href="autoplot.sim_list.html">autoplot.sim_list()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters, not used currently</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a date frame, see details</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The exact behaviour depends on the value of <code>flows</code>. In all cases, the
function returns a data frame. The data frame has one column per quantile,
named after the quantile using a percentage based named, as in the default
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">stats::quantile()</a></code>. For a graphical representation of those quantiles, see
<code><a href="autoplot.sim_list.html">autoplot.sim_list()</a></code>.</p><ul><li><p>if <code>flows="full"</code>: this is the default case in which the function
computes for each pair of origin \(o\) and destination \(d\) locations
the quantiles of the distribution of the flow from \(o\) to \(d\) in the
collection of models (the flows maybe normalised before quantile
calculations, depending on the value of <code>normalisation</code>). In addition to the
quantiles, the data frame has two columns:</p><ul><li><p><code>origin_idx</code>: identifies the origin location by its index from 1 to the number
of origin locations;</p></li>
<li><p><code>destination_idx</code>: identifies the destination location by its index from 1
to the number of destination locations.</p></li>
</ul></li>
<li><p>if <code>flows="destination"</code>, the function computes quantiles for each
destination \(d\) location of the distribution of its incoming flow
(<code><a href="destination_flow.html">destination_flow()</a></code>) in the collection of models. In addition to the
quantiles, the data frame has one column <code>destination</code> that identifies the
destination location by its index from 1 to the number of destination
locations.</p></li>
<li><p>if <code>flows="attractiveness"</code>, the function computes quantiles for each
destination \(d\) location of the distribution of its attractiveness
(<code><a href="attractiveness.html">attractiveness()</a></code>) in the collection of models. In addition to the
quantiles, the data frame has one column <code>destination</code> that identifies the
destination location by its index from 1 to the number of destination
locations.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fortify.sim_list.html">fortify.sim_list()</a></code> <code><a href="autoplot.sim_list.html">autoplot.sim_list()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="va">french_cities_distances</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span> <span class="co">## convert to km</span></span></span>
<span class="r-in"><span><span class="va">production</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">attractiveness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">french_cities</span><span class="op">$</span><span class="va">area</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">all_flows</span> <span class="op">&lt;-</span> <span class="fu"><a href="grid_blvim.html">grid_blvim</a></span><span class="op">(</span><span class="va">distances</span>, <span class="va">production</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.45</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="fl">400</span>,</span></span>
<span class="r-in"><span>  <span class="va">attractiveness</span>,</span></span>
<span class="r-in"><span>  bipartite <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  epsilon <span class="op">=</span> <span class="fl">0.1</span>, iter_max <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">all_flows</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   origin_idx destination_idx           0%         25%        50%        75%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1               1 0.7243813443 0.791508067 0.86872582 0.94540077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2               1 0.0005096627 0.004080883 0.01547892 0.06524731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          3               1 0.0259905430 0.068413565 0.24311397 0.31257755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4               1 0.0047697000 0.013247367 0.10571429 0.18820630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5               1 0.0006900334 0.003163334 0.01883933 0.06524736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          6               1 0.0527184836 0.107513229 0.65084792 0.80560083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.9778068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.1306230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.3955416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.3243445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.1327188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.9492135</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">all_flows</span>, flows <span class="op">=</span> <span class="st">"destination"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   destination           0%          25%          50%          75%      100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 1.064013e+00 1.357607e+00 3.537690e+00 4.500767e+00 4.9076303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2 2.644311e-27 1.577667e+00 4.302950e+00 5.092370e+00 5.4992328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3 8.720603e-63 5.864564e-44 1.334964e-27 1.336506e-07 0.9023744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4 9.558027e-62 2.082119e-34 3.105876e-22 7.298803e-03 0.9637403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5 2.036938e-64 5.148087e-50 3.168389e-36 2.590305e-27 0.8184971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           6 1.055197e-63 1.217695e-29 3.518563e-20 8.580367e-01 0.9752023</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">all_flows</span>,</span></span>
<span class="r-in"><span>  flows <span class="op">=</span> <span class="st">"attractiveness"</span>,</span></span>
<span class="r-in"><span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   destination          10%          30%          60%       90%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 1.149829e+00 2.054336e+00 3.932103e+00 4.8717817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2 1.600450e-05 2.129355e+00 4.417651e+00 5.1455216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3 3.233102e-40 2.556690e-29 5.300175e-18 0.6943906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4 2.602864e-36 2.740750e-23 5.120037e-15 0.9254629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5 1.136226e-42 1.796658e-34 3.319068e-26 0.3598985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           6 1.088399e-35 2.998592e-21 9.137419e-08 0.9542375</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fabrice Rossi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

