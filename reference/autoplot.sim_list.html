<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a complete variability for a collection of spatial interaction models — autoplot.sim_list • blvim</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a complete variability for a collection of spatial interaction models — autoplot.sim_list"><meta name="description" content="This function represents graphically the variability of the flows represented
by the spatial interaction models contained in a collection (a sim_list
object)."><meta property="og:description" content="This function represents graphically the variability of the flows represented
by the spatial interaction models contained in a collection (a sim_list
object)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blvim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/grid.html">Systematic exploration of the BLV solution space</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theoretical Background</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fabrice-rossi/blvim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a complete variability for a collection of spatial interaction models</h1>
      <small class="dont-index">Source: <a href="https://github.com/fabrice-rossi/blvim/blob/main/R/sim_list_autoplot.R" class="external-link"><code>R/sim_list_autoplot.R</code></a></small>
      <div class="d-none name"><code>autoplot.sim_list.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function represents graphically the variability of the flows represented
by the spatial interaction models contained in a collection (a <code>sim_list</code>
object).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'sim_list'</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  flows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"destination"</span>, <span class="st">"attractiveness"</span><span class="op">)</span>,</span>
<span>  with_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  with_positions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cut_off <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  adjust_limits <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  with_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  qmin <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  qmax <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  normalisation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"origin"</span>, <span class="st">"full"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a collection of spatial interaction models, a <code>sim_list</code></p></dd>


<dt id="arg-flows">flows<a class="anchor" aria-label="anchor" href="#arg-flows"></a></dt>
<dd><p><code>"full"</code> (default),  <code>"destination"</code> or <code>"attractiveness"</code>, see
details.</p></dd>


<dt id="arg-with-names">with_names<a class="anchor" aria-label="anchor" href="#arg-with-names"></a></dt>
<dd><p>specifies whether the graphical representation includes
location names (<code>FALSE</code> by default)</p></dd>


<dt id="arg-with-positions">with_positions<a class="anchor" aria-label="anchor" href="#arg-with-positions"></a></dt>
<dd><p>specifies whether the graphical representation is based
on location positions (<code>FALSE</code> by default)</p></dd>


<dt id="arg-cut-off">cut_off<a class="anchor" aria-label="anchor" href="#arg-cut-off"></a></dt>
<dd><p>cut off limit for inclusion of a graphical primitive when
<code>with_positions = TRUE</code>. In the attractiveness or destination
representation, circles are removed when the corresponding upper quantile
value is below the cut off.</p></dd>


<dt id="arg-adjust-limits">adjust_limits<a class="anchor" aria-label="anchor" href="#arg-adjust-limits"></a></dt>
<dd><p>if <code>FALSE</code> (default value), the limits of the position
based graph are not adjusted after removing graphical primitives. This
eases comparison between graphical representations with different cut off
value. If <code>TRUE</code>, limits are adjusted to the data using the standard
ggplot2 behaviour.</p></dd>


<dt id="arg-with-labels">with_labels<a class="anchor" aria-label="anchor" href="#arg-with-labels"></a></dt>
<dd><p>if <code>FALSE</code> (default value) names are displayed using plain
texts. If <code>TRUE</code>, names are shown using labels.</p></dd>


<dt id="arg-qmin">qmin<a class="anchor" aria-label="anchor" href="#arg-qmin"></a></dt>
<dd><p>lower quantile, see details (default: 0.05)</p></dd>


<dt id="arg-qmax">qmax<a class="anchor" aria-label="anchor" href="#arg-qmax"></a></dt>
<dd><p>upper quantile, see details (default: 0.95)</p></dd>


<dt id="arg-normalisation">normalisation<a class="anchor" aria-label="anchor" href="#arg-normalisation"></a></dt>
<dd><p>when <code>flows="full"</code>, the flows can be reported without
normalisation (<code>normalisation="none"</code>) or they can be normalised, either
to sum to one for each origin location (<code>normalisation="origin"</code>, the default
value) or to sum to one globally (<code>normalisation="full"</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters, not used currently</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The graphical representation depends on the values of <code>flows</code> and
<code>with_positions</code>. It is based on the data frame representation produced by
<code><a href="fortify.sim_list.html">fortify.sim_list()</a></code>. In all cases, the variations of the flows are
represented via quantiles of their distribution over the collection of
models. For instance, when <code>flows</code> is <code>"destination"</code>, the function computes
the quantiles of the incoming flows observed in the collection at each
destination. We consider three quantiles:</p><ul><li><p>a lower quantile <code>qmin</code> defaulting to 0.05;</p></li>
<li><p>the median;</p></li>
<li><p>a upper quantile <code>qmax</code> defaulting to 0.95.</p></li>
</ul><p>If <code>with_position</code> is <code>FALSE</code> (default value), the graphical representations
are "abstract". Depending on <code>flows</code> we have the following representations:</p><ul><li><p><code>"full"</code>: the function displays the quantiles over the collection of models
of the flows using nested squares (<code><a href="flows.html">flows()</a></code>). The graph is organised as matrix with
origin locations on rows and destination locations on columns. At each row and
column intersection, three nested squares represent respectively the lower quantile,
the median and the upper quantile of the distribution of the flows between the
corresponding origin and destination locations over the collection of models. The
median square borders are thicker than the other two squares. The area of
each square is proportional to the represented value.</p></li>
<li><p><code>"destination"</code>: the function displays the quantiles over the collection of
models of the incoming flows for each destination location (using
<code><a href="destination_flow.html">destination_flow()</a></code>). Quantiles are represented using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">ggplot2::geom_crossbar()</a></code>: each location is represented by a rectangle that
spans from its lower quantile to its upper quantile. An intermediate thicker
bar represents the median quantile.</p></li>
<li><p><code>"attractiveness"</code>: the function displays the quantiles over the collection of
models of the attractiveness of each destination location (as given by
<code><a href="attractiveness.html">attractiveness()</a></code>). The graphical representation is the same as for
<code>"destination"</code>. This is interesting for dynamic models where those values
are updated during the iterations (see <code><a href="blvim.html">blvim()</a></code> for details). When the
calculation has converged (see <code><a href="sim_converged.html">sim_converged()</a></code>), both <code>"destination"</code> and
<code>"attractiveness"</code> graphics should be almost identical.</p></li>
</ul><p>When the <code>with_names</code> parameter is <code>TRUE</code>, the location names
(<code><a href="location_names.html">location_names()</a></code>) are used to label the axis of the graphical
representation. If names are not specified, they are replaced by indexes.</p>
<p>When the <code>with_positions</code> parameter is <code>TRUE</code>, the location positions
(<code><a href="location_positions.html">location_positions()</a></code>) are used to produce more "geographically informed"
representations. Notice that if no positions are known for the locations, the
use of <code>with_positions = TRUE</code> is an error. Moreover, <code>flows = "full"</code> is not
supported: the function will issue a warning and revert to the position free
representation if this value is used.</p>
<p>The representations for <code>flows="destination"</code> and <code>flows="attractiveness"</code> are
based on the same principle. Each destination location is represented by a
collection of three nested circles centred on the corresponding location
position, representing respectively the lower quantile, the median and the upper
quantile of the incoming flows or of the attractivenesses. The diameters of
the circles are proportional to the quantities they represent. The border ot
the median circle is thicker than the ones of the other circles.</p>
<p>When both <code>with_positions</code> and <code>with_names</code> are <code>TRUE</code>, the names
of the destinations are added to the graphical representation. If <code>with_labels</code>
is <code>TRUE</code> the names are represented as labels instead of plain texts
(see <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_label()</a></code>). If the <code>ggrepel</code> package is installed, its
functions are used instead of <code>ggplot2</code> native functions.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fortify.sim_list.html">fortify.sim_list()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">positions</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">production</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">attractiveness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">all_flows</span> <span class="op">&lt;-</span> <span class="fu"><a href="grid_blvim.html">grid_blvim</a></span><span class="op">(</span><span class="va">distances</span>, <span class="va">production</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.45</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">attractiveness</span>,</span></span>
<span class="r-in"><span>  bipartite <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  epsilon <span class="op">=</span> <span class="fl">0.1</span>, iter_max <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  destination_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>names <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, positions <span class="op">=</span> <span class="va">positions</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  origin_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>names <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, positions <span class="op">=</span> <span class="va">positions</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>, with_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>, with_names <span class="op">=</span> <span class="cn">TRUE</span>, normalisation <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>,</span></span>
<span class="r-in"><span>  flow <span class="op">=</span> <span class="st">"destination"</span>, with_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  qmin <span class="op">=</span> <span class="fl">0</span>, qmax <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>,</span></span>
<span class="r-in"><span>  flow <span class="op">=</span> <span class="st">"destination"</span>, with_positions <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  qmin <span class="op">=</span> <span class="fl">0</span>, qmax <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_continuous</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>,</span></span>
<span class="r-in"><span>  flow <span class="op">=</span> <span class="st">"destination"</span>, with_positions <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  qmin <span class="op">=</span> <span class="fl">0</span>, qmax <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  cut_off <span class="op">=</span> <span class="fl">1.1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">all_flows</span>,</span></span>
<span class="r-in"><span>  flow <span class="op">=</span> <span class="st">"destination"</span>, with_positions <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  with_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  with_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  qmin <span class="op">=</span> <span class="fl">0</span>, qmax <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  cut_off <span class="op">=</span> <span class="fl">1.1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.sim_list-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fabrice Rossi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

